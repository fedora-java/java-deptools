@(collections: Iterable[org.fedoraproject.javadeptools.model.PackageCollection],
    currentCollection: org.fedoraproject.javadeptools.model.PackageCollection,
    page: Option[Page[org.fedoraproject.javadeptools.model.ClassEntry]]
    )(implicit request:play.api.mvc.RequestHeader)

@main("Search for Java classes in Fedora", "search") {
    <form method="GET" action="@routes.Application.index(1)">
         <input type="text" name="q" value="@request.getQueryString("q").getOrElse("")"
                autofocus="autofocus"/>
         <select name="collection">
            @for(collection <- collections) {
                <option value="@collection.getName" @if(collection eq currentCollection) {selected="selected"}>@collection.getName</option>
            }
         </select>
         <button type="submit">Search</button>
    </form>
    @page match {
        case Some(page) => {
            <div>Showing results from @page.from to @page.to of total @page.totalCount</div>
            @defining(request.getQueryString("q").getOrElse("")) { q =>
                <ul class="pagination">
                    @if(page.currentPage == 1) {
                        <li class="disabled"><a href="#">Previous</a></li>
                    } else {
                        <li>
                            <a href="@routes.Application.index(page.currentPage - 1, q, Some(currentCollection.getName))">Previous</a>
                        </li>
                    }
                    @if(page.currentPage > page.maxPage) {
                        <li class="disabled"><a href="#">Next</a></li>
                    } else {
                        <li>
                            <a href="@routes.Application.index(page.currentPage + 1, q, Some(currentCollection.getName))">Next</a>
                        </li>
                    }
                </ul>
            }
            <table id="class-table" class="table table-condensed">
                <tr>
                    <th></th>
                    <th>Java class</th>
                    <th>JAR name</th>
                    <th>Package name</th>
                </tr>
                @for(row <-page.content) {
                <tr>
                    <td>@if(row.getPackageName){ @(row.getPackageName). }</td>
                    <td>@row.getClassName</td>
                    <td><span title="@row.getFileArtifact.getPath">@row.getFileArtifact.getPath.split("/").last</span></td>
                    <td>@row.getFileArtifact.getPkg.getName</td>
                </tr>
            }
            </table>
        }
        case None => {}
    }
}